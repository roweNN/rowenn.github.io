import{d as K,r,o as le,a as ee,b as M,A as te,w as ae,k as w,B as ke,f as Z,e,t as k,l as de,q as O,v as S,j,R as ne,D as R,y as X,s as se,c as N,n as fe,m as W,F as Q,h as oe,C as $e,G as J,E as pe,g as ce,p as xe,H as me,i as Ae}from"./index.a53329dd.js";import{a as F}from"./axios.95d71f80.js";import{d as H,E as ve}from"./es.b393bca0.js";const Re={class:"grid grid-cols-6 gap-2"},Oe={class:"col-span-6 mt-5"},Ie={class:"font-bold"},Me={class:"col-span-4"},Fe=e("option",null,"Remuneraciones",-1),Se=e("option",null,"Servicios",-1),Te=e("option",null,"Aseo y mantencion",-1),Ne=e("option",null,"Otros",-1),Ue=[Fe,Se,Te,Ne],De={class:"col-span-2"},Le={class:"col-span-4"},Pe=e("small",null,"DESCRIPCION",-1),Ve={class:"col-span-2"},Ge=e("small",null,"MONTO",-1),Ye={class:"col-span-2"},ze=e("small",null,"ESTADO DEL PAGO",-1),Be=e("option",null,"Pendiente",-1),je=e("option",null,"Pagado",-1),qe=[Be,je],He={class:"col-span-2"},We=e("small",null,"FECHA DEL PAGO",-1),Ke={class:"col-span-2"},Ze=e("small",null,"MEDIO DE PAGO",-1),Je={class:"col-span-2"},Xe=e("small",null,"REF PAGO",-1),Qe={class:"col-span-6"},et=e("small",null,"NOTAS",-1),tt=e("div",{class:"col-span-6 py-2"},null,-1),ot={class:"col-span-3 py-2"},lt={class:"col-span-3 py-2"},st={class:"col-span-1"},be=K({__name:"expenseModal",props:{locationId:{},id:{},month:{}},emits:["close","confirm"],setup(P,{emit:D}){const l=P,f=D,g=r(""),v=r(""),s=r(""),p=r(""),$=r(""),A=r(""),c=r(""),b=r(""),x=r(!1),m=r(""),u=async()=>{await F.post("/expense",{location:l.locationId,category:g.value,name:`${v.value} (Copia)`,amount:s.value,paymentStatus:"pending",paymentDate:$.value,payment:A.value,paymentRef:c.value,notes:b.value,month:m.value}),R({type:"success",title:"Success",text:"Expense copied"}),f("confirm")},a=async()=>{try{if(!window.confirm("Seguro que deseas borrar?"))return;await F.delete(`/expense/${l.id}`),R({type:"success",title:"Success",text:"Expense deleted"}),f("confirm")}catch(d){console.error(d),R({type:"error",title:"Error",text:"Error deleting expense"})}},n=async()=>{await F.post("/expense",{location:l.locationId,category:g.value,name:v.value,amount:s.value,paymentStatus:p.value,paymentDate:$.value,payment:A.value,paymentRef:c.value,notes:b.value,month:l.month})},I=async()=>{try{if(!g.value||!v.value||!s.value||!p.value){R({type:"error",title:"Error",text:"Complete los campos requeridos"});return}l.id?await F.put(`/expense/${l.id}`,{category:g.value,name:v.value,amount:s.value,paymentStatus:p.value,paymentDate:$.value,payment:A.value,paymentRef:c.value,notes:b.value,month:m.value}):n(),R({type:"success",title:"Success",text:"Expense created"}),f("confirm")}catch(d){console.error(d),R({type:"error",title:"Error",text:"Error creating expense"})}},C=async()=>{try{if(x.value=!0,l.id){const d=await F.get(`/expense/${l.id}`);g.value=d.data.category,v.value=d.data.name,s.value=d.data.amount,p.value=d.data.paymentStatus,$.value=d.data.paymentDate,A.value=d.data.payment,c.value=d.data.paymentRef,b.value=d.data.notes,m.value=d.data.month}}catch(d){console.error(d),R({type:"error",title:"Error",text:"Error loading expense"})}finally{x.value=!1}};return le(()=>{l.id&&C()}),(d,_)=>{const q=ee("Loading");return M(),te(j(ne),{class:"flex justify-center items-center w-full h-full","content-class":"flex flex-col max-w-xl mx-4 p-4 bg-white border dark:border-gray-700 rounded-lg space-y-2"},{default:ae(()=>[w(Z(q,null,null,512),[[ke,x.value]]),e("div",Re,[e("div",Oe,[e("span",Ie,"INFORMACION DEL PAGO "+k(l.month),1)]),e("div",Me,[w(e("select",{class:O(["w-full p-2 border rounded",{"border-red-500":!g.value}]),"onUpdate:modelValue":_[0]||(_[0]=i=>g.value=i)},Ue,2),[[de,g.value]])]),e("div",De,[w(e("input",{type:"text","onUpdate:modelValue":_[1]||(_[1]=i=>m.value=i),class:"border rounded w-full"},null,512),[[S,m.value]])]),e("div",Le,[Pe,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":!v.value}]),placeholder:"Pago de sueldos","onUpdate:modelValue":_[2]||(_[2]=i=>v.value=i)},null,2),[[S,v.value]])]),e("div",Ve,[Ge,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":!s.value}]),placeholder:"150000","onUpdate:modelValue":_[3]||(_[3]=i=>s.value=i)},null,2),[[S,s.value]])]),e("div",Ye,[ze,w(e("select",{class:O(["w-full p-2 border rounded",{"border-red-500":!p.value}]),"onUpdate:modelValue":_[4]||(_[4]=i=>p.value=i)},qe,2),[[de,p.value]])]),e("div",He,[We,w(e("input",{type:"date",class:"w-full p-2 border rounded",placeholder:"Nombre","onUpdate:modelValue":_[5]||(_[5]=i=>$.value=i)},null,512),[[S,$.value]])]),e("div",Ke,[Ze,w(e("input",{type:"text",class:"w-full p-2 border rounded",placeholder:"Nombre","onUpdate:modelValue":_[6]||(_[6]=i=>A.value=i)},null,512),[[S,A.value]])]),e("div",Je,[Xe,w(e("input",{type:"text",class:"w-full p-2 border rounded",placeholder:"Nombre","onUpdate:modelValue":_[7]||(_[7]=i=>c.value=i)},null,512),[[S,c.value]])]),e("div",Qe,[et,w(e("textarea",{class:"w-full p-2 border rounded",placeholder:"Notas adicionales","onUpdate:modelValue":_[8]||(_[8]=i=>b.value=i)},null,512),[[S,b.value]])]),tt,e("div",ot,[e("button",{onClick:_[9]||(_[9]=i=>a()),class:"text-red-500"},"Eliminar")]),e("div",lt,[e("button",{onClick:_[10]||(_[10]=i=>u()),class:"text-yellow-500"},"Copiar")]),e("div",st,[e("button",{class:"w-full py-1.5 border rounded-lg bg-gray-600 text-white",onClick:_[11]||(_[11]=i=>d.$emit("close"))}," CERRAR ")]),e("div",{class:"col-span-5"},[e("button",{class:"w-full w-50 px-4 py-1.5 border rounded-lg bg-green-600 text-white",onClick:I}," GUARDAR ")])])]),_:1})}}});H.locale("es");function we(P,D="DD-MM-YYYY"){return H(P).format(D)}function V(P,D=0){P.toString().indexOf(".")!=-1&&P.toString()[P.toString().indexOf(".")+1].length>5&&(P=P+1);let l=P.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");return l.indexOf(".")>-1&&(l=l.substring(0,l.indexOf(".")).replace(/,/g,".")),l}const at={class:"grid grid-cols-12"},nt={class:"col-span-12 mt-5"},rt={class:"grid grid-cols-12"},dt={class:"col-span-10 uppercase text-xl"},ct={class:"col-span-2 text-right"},it=e("div",{class:"col-span-2"},null,-1),ut={class:"col-span-12 py-2"},pt=e("small",null,"BUSCAR",-1),vt={class:"col-span-12"},mt=$e('<div class="grid grid-cols-12 gap-x-4 border-b items-center font-bold bg-slate-500 text-white px-2"><div class="col-span-2"><small>FECHA</small></div><div class="col-span-4"><small>DETALLE</small></div><div class="col-span-4"><small>CATEGORIA</small></div><div class="col-span-2 text-right"><small>TOTAL</small></div><div class="col-span-2"></div></div>',1),gt={key:0,class:"col-span-12"},ht=e("div",{class:"py-10 text-center"},"No hay informacion",-1),_t=[ht],bt=["onClick"],yt={class:"col-span-2"},ft={class:"col-span-4"},$t={class:"col-span-2"},xt={class:"col-span-2"},wt={class:"col-span-2 text-right"},Ct=e("div",{class:"col-span-2"},null,-1),Et=K({__name:"expenses",props:{locationId:{},month:{}},setup(P,{expose:D}){const l=r([]),f=P,g=r(""),v=r([]),s=()=>{console.log("search"),g.value==""&&(v.value=l.value),v.value=l.value.filter(b=>b.name.toLowerCase().includes(g.value.toLowerCase()))},p=X(()=>V(l.value.reduce((b,x)=>b+x.amount,0))),$=async()=>{try{const b=await F.get(`/expense?location=${f.locationId}&month=${f.month}`);l.value=b.data,s()}catch(b){console.error(b),R({type:"error",title:"Error",text:"Error loading expenses"})}},A=()=>{const{open:b,close:x}=J({component:be,attrs:{locationId:f.locationId,month:f.month,onConfirm(m){console.log("onConfirm",m),$(),x()},onClose(){$(),x()}}});b()},c=b=>{const{open:x,close:m}=J({component:be,attrs:{locationId:f.locationId,id:b,onConfirm(u){console.log("onConfirm",u),$(),m()},onClose(){$(),m()}}});x()};return le(()=>{console.log({props:f})}),se(()=>f.month,()=>{console.log("change month"),$()}),se(()=>g.value,()=>{g.value==""&&s()}),D({load:$}),(b,x)=>(M(),N("div",at,[e("div",{class:"col-span-12 ml-auto"},[e("button",{onClick:A,class:"bg-blue-500 pull-right block text-center text-white px-5 rounded py-1"}," AGREGAR ")]),e("div",nt,[e("div",rt,[e("div",dt," GASTOS DE "+k(j(H)(b.month,"YY-MM").format("MMMM [de] YY")),1),e("div",ct,[e("strong",null,"$"+k(p.value),1)]),it,e("div",ut,[pt,w(e("input",{type:"text",class:"w-full p-1.5 border-gray-300 rounded",placeholder:"Buscar gasto","onUpdate:modelValue":x[0]||(x[0]=m=>g.value=m),onKeyup:x[1]||(x[1]=fe(m=>s(),["enter"]))},null,544),[[S,g.value]])])])]),e("div",vt,[mt,v.value.length==0?(M(),N("div",gt,_t)):W("",!0),(M(!0),N(Q,null,oe(v.value,m=>(M(),N("div",{class:O(["grid grid-cols-12 gap-x-4 gap border-b items-center px-2 hover:bg-gray-200 cursor-pointer",{"bg-yellow-100":m.paymentStatus!=="Pagado"}]),onClick:u=>c(m._id),key:m._id},[e("div",yt,[e("small",null,k(we(m.createdAt)),1)]),e("div",ft,[e("strong",null,k(m.name),1)]),e("div",$t,[e("span",null,k(m.category),1)]),e("div",xt,[e("span",null,k(m.paymentStatus),1)]),e("div",wt,[e("strong",null,"$"+k(V(m.amount)),1)]),Ct],10,bt))),128))])]))}}),kt={class:"grid grid-cols-6 gap-2"},At={class:"col-span-6 mt-5"},Rt={class:"font-bold"},Ot={class:"col-span-6"},It=e("small",null,"UNIDAD",-1),Mt=["disabled"],Ft=e("option",{value:null},"No aplica",-1),St=["value"],Tt={key:0,class:"grid grid-col-6"},Nt={class:"col-span-2"},Ut=e("small",null,"CATEGORIA",-1),Dt=["onUpdate:modelValue","onChange"],Lt=e("option",null,"Recaudacion de gastos comun",-1),Pt=e("option",null,"Agua",-1),Vt=e("option",null,"Morosidad",-1),Gt=e("option",null,"Multas",-1),Yt=e("option",null,"Multas Otras",-1),zt=e("option",null,"Arriendos",-1),Bt=[Lt,Pt,Vt,Gt,Yt,zt],jt={class:"col-span-2"},qt=e("small",null,"DESCRIPCION",-1),Ht=["onUpdate:modelValue"],Wt=["onClick"],Kt=["onClick"],Zt={class:"col-span-2"},Jt=e("small",null,"MONTO",-1),Xt=["onUpdate:modelValue"],Qt={class:"col-span-2"},eo=e("small",null,"ESTADO DE PAGO",-1),to=["onUpdate:modelValue"],oo=e("option",{value:"pending"},"Pendiente",-1),lo=e("option",{value:"paid"},"Pagado",-1),so=[oo,lo],ao={class:"grid grid-cols-2 hidden"},no={class:"col-span"},ro=["onClick"],co={class:"col-span"},io=["onClick"],uo={class:"col-span-3"},po=e("small",null,"MEDIO DE PAGO",-1),vo=["onUpdate:modelValue"],mo=["onClick"],go=["onClick"],ho=["onClick"],_o={class:"col-span-1"},bo=e("small",null,"REF DE PAGO",-1),yo=["onUpdate:modelValue"],fo=e("small",{class:"text-gray-500"},"Ej: N\xB0 de comprobante",-1),$o={class:"grid grid-cols-6"},xo={class:"col-span-6"},wo={class:"col-span-6"},Co=e("div",{class:"col-span-6 py-2"},null,-1),Eo={class:"col-span-6"},ko={class:"col-span-1"},ge=K({__name:"paymentModal",props:{locationId:{},roomId:{},category:{},amount:{},name:{},penaltyfees:{},month:{},id:{}},emits:["close","confirm"],setup(P,{emit:D}){const l=P,f=D,g=r(""),v=r([]),s=r(""),p=r([]),$=r(""),A=r(""),c=r(!1),b=r(!1),x=r(""),m=r(!0),u=r(""),a=r(""),n=r(""),I=r("paid"),C=r({_id:"",name:"",value:""}),d=()=>{v.value.push({name:g.value,amount:s.value,paymentMethod:$.value,paymentRef:A.value,notifyPayment:c.value,conciliation:b.value,category:x.value,room:u.value,status:I.value})},_=async()=>{try{if(!window.confirm("Are you sure?"))return;await F.delete(`/payment/${l.id}`),R({type:"success",title:"Success",text:"Payment removed"}),f("confirm")}catch(h){console.log(h),R({type:"error",title:"Error",text:"Error removing payment"})}},q=async()=>{try{if(m.value=!0,l.id){const[h]=v.value;if(!h)return;await F.put(`/payment/${l.id}`,{name:h.name,amount:h.amount,paymentMethod:h.paymentMethod,paymentRef:h.paymentRef,category:h.category,notifyPayment:c.value,conciliation:b.value,room:u.value,status:h.status})}else await F.post("/payment",{location:l.locationId,month:l.month,room:u.value,notifyPayment:c.value,conciliation:b.value,payments:v.value});g.value="",s.value="",R({type:"success",title:"Success",text:"Payment saved"}),f("confirm")}catch(h){console.log(h),R({type:"error",title:"Error",text:"Error saving payment"})}finally{m.value=!1}},i=(h,L)=>{const G=h.target.value;console.log("category",G);try{G==="Recaudacion de gastos comun"&&!l.id&&(console.log("room",C.value),L.amount=parseInt(C.value.value)||0),G==="Agua"&&!l.id&&(console.log("room",C.value),L.amount=parseInt(n.value)||0)}catch(E){console.log("changeCategory",E)}};se(()=>v,()=>{});const T=async()=>{try{m.value=!0;const{data:h}=await F.get(`/location/${l.locationId}`);p.value=h.floors.map(L=>L.rooms).flat()}catch(h){console.log(h),R({type:"error",title:"Error",text:"Error loading"})}finally{m.value=!1}},t=async()=>{try{m.value=!0;const{data:h}=await F.get(`/location/${l.locationId}/room/${l.roomId}`);C.value=h}catch(h){console.log(h),R({type:"error",title:"Error",text:"Error loading room"})}finally{m.value=!1}},o=async()=>{try{m.value=!0;const{data:h}=await F.get(`/location/${l.locationId}/room/${l.roomId}/water?month=${l.month}`);if(h===null)return;a.value=h._id,n.value=h.value}catch{R({type:"error",title:"Error",text:"Error loading water"}),f("close")}finally{m.value=!1}},Y=async()=>{try{m.value=!0;const{data:h}=await F.get(`/payment/${l.id}`);c.value=h.notifyPayment,b.value=h.conciliation,u.value=h.room,v.value.push({name:h.name,amount:h.amount,paymentMethod:h.paymentMethod,paymentRef:h.paymentRef,category:h.category,status:h.status})}catch(h){console.log(h),R({type:"error",title:"Error",text:"Error loading payment"})}finally{m.value=!1}};return le(()=>{T(),l.roomId&&(u.value=l.roomId,t(),o()),l.category&&(x.value=l.category),l.amount&&(s.value=l.amount),l.name&&(g.value=l.name),l.id?Y():d()}),(h,L)=>{const G=ee("Loading");return M(),te(j(ne),{class:"flex justify-center items-center w-full h-full","content-class":"flex flex-col max-w-6xl mx-4 p-4 bg-white border dark:border-gray-700 rounded-lg space-y-2"},{default:ae(()=>[Z(G,{visible:m.value},null,8,["visible"]),e("div",kt,[e("div",At,[e("span",Rt,"INFORMACION DEL PAGO "+k(l.month),1)]),e("div",Ot,[It,w(e("select",{class:"w-full p-2 border rounded","onUpdate:modelValue":L[0]||(L[0]=E=>u.value=E),disabled:l.roomId||l.id},[Ft,(M(!0),N(Q,null,oe(p.value,E=>(M(),N("option",{value:E._id,key:E._id},k(E.name),9,St))),128))],8,Mt),[[de,u.value]])])]),l.id?W("",!0):(M(),N("div",Tt,[e("div",{class:"col-span-6"},[e("button",{onClick:d,class:"w-full px-4 py-1 border rounded-lg bg-gray-600 text-white"}," Agregar pago ")])])),(M(!0),N(Q,null,oe(v.value,E=>(M(),N("div",{class:"grid grid-cols-12",key:E._id},[e("div",Nt,[Ut,w(e("select",{class:O(["w-full p-2 border rounded",{"border-red-500":!E.category}]),"onUpdate:modelValue":y=>E.category=y,ref_for:!0,ref:"category-select",onChange:y=>i(y,E)},Bt,42,Dt),[[de,E.category]])]),e("div",jt,[qt,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":!E.name}]),placeholder:"Nombre","onUpdate:modelValue":y=>E.name=y},null,10,Ht),[[S,E.name]]),e("small",{class:"cursor-pointer px-2 border bg-gray-100",onClick:y=>E.name="Pago"}," Pago ",8,Wt),e("small",{class:"cursor-pointer px-2 border bg-gray-100",onClick:y=>E.name="Abono"}," Abono ",8,Kt)]),e("div",Zt,[Jt,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":!E.amount}]),placeholder:"Nombre","onUpdate:modelValue":y=>E.amount=y},null,10,Xt),[[S,E.amount,void 0,{number:!0}]])]),e("div",Qt,[eo,w(e("select",{class:"w-full p-2 border rounded","onUpdate:modelValue":y=>E.status=y},so,8,to),[[de,E.status]]),e("div",ao,[e("div",no,[e("button",{class:O(["w-full px-4 py-1 border rounded-lg",{"bg-yellow-600 text-white":I.value==="pending","bg-gray-300":E.status!=="pending"}]),onClick:y=>E.status="pending"}," PENDIENTE ",10,ro)]),e("div",co,[e("button",{class:O(["w-full px-4 py-1 border rounded-lg",{"bg-green-600 text-white":I.value==="paid","bg-gray-300":E.status!=="paid"}]),onClick:y=>E.status="paid"}," PAGADO ",10,io)])])]),e("div",uo,[po,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":!E.paymentMethod}]),placeholder:"Efectivo, Transferencia, Cheque","onUpdate:modelValue":y=>E.paymentMethod=y},null,10,vo),[[S,E.paymentMethod]]),e("small",{class:"cursor-pointer px-2 border bg-gray-100",onClick:y=>E.paymentMethod="Efectivo"},"Efectivo",8,mo),e("small",{class:"cursor-pointer px-2 border bg-gray-100",onClick:y=>E.paymentMethod="Transferencia"},"Transferencia",8,go),e("small",{class:"cursor-pointer px-2 border bg-gray-100",onClick:y=>E.paymentMethod="Cheque"},"Cheque",8,ho)]),e("div",_o,[bo,w(e("input",{type:"text",class:"w-full p-2 border rounded",placeholder:"12345679","onUpdate:modelValue":y=>E.paymentRef=y},null,8,yo),[[S,E.paymentRef]]),fo])]))),128)),e("div",$o,[e("div",xo,[w(e("input",{type:"checkbox","onUpdate:modelValue":L[1]||(L[1]=E=>c.value=E),name:"",id:""},null,512),[[pe,c.value]]),ce(" Notificar registro de pago ")]),e("div",wo,[w(e("input",{type:"checkbox",name:"",id:"","onUpdate:modelValue":L[2]||(L[2]=E=>b.value=E)},null,512),[[pe,b.value]]),ce(" Crear pago con estado conciliado ")]),Co,e("div",Eo,[l.id?(M(),N("button",{key:0,onClick:L[3]||(L[3]=E=>_()),class:"w-full w-50 px-4 py-1 border rounded-lg border-red-500 text-red-500 hover:bg-red-500 hover:text-white"}," ELIMINAR ")):W("",!0)]),e("div",ko,[e("button",{class:"w-full py-2 border rounded-lg bg-gray-600 text-white",onClick:L[4]||(L[4]=E=>h.$emit("close"))}," CERRAR ")]),e("div",{class:"col-span-5"},[e("button",{class:"w-full w-50 px-4 py-2 border rounded-lg bg-green-600 text-white",onClick:q}," GUARDAR ")])])]),_:1})}}}),Ao={class:"grid grid-cols-12 gap-x-2"},Ro=e("div",{class:"col-span-10 ml-auto"},null,-1),Oo=e("div",{class:"col-span-12 mt-5"},null,-1),Io={class:"col-span-6"},Mo={class:"uppercase text-xl"},Fo={class:"col-span-6 text-right"},So={class:"block text-green-500"},To={class:"block text-yellow-500"},No={class:"col-span-8"},Uo=e("small",null,"BUSCAR",-1),Do=["onKeyup"],Lo={class:"col-span-4"},Po=e("small",null,"ESTADO DE PAGO",-1),Vo=e("option",{value:""},"Todos",-1),Go=e("option",{value:"pending"},"Pendiente",-1),Yo=e("option",{value:"paid"},"Pagado",-1),zo=[Vo,Go,Yo],Bo={key:0,class:"col-span-12"},jo={class:"grid grid-cols-7"},qo={class:"col-span-4 content-end"},Ho=e("small",null,"MEDIO DE PAGO",-1),Wo=e("option",null,"Efectivo",-1),Ko=e("option",null,"Transferencia",-1),Zo=e("option",null,"Tarjeta",-1),Jo=e("option",null,"Cheque",-1),Xo=[Wo,Ko,Zo,Jo],Qo={class:"col-span-3 content-end"},el=["disabled"],tl=$e('<div class="col-span-1"><small>FECHA</small></div><div class="col-span-4"><small>DETALLE</small></div><div class="col-span-4"><small>CATEGORIA</small></div><div class="col-span-2 text-right"><small>TOTAL</small></div><div class="col-span-2"></div>',5),ol={class:"col-span-12 h-[600px] overflow-y-scroll"},ll={key:0,class:"text-center py-5"},sl=e("p",null,"No se encontraron pagos",-1),al=[sl],nl={class:"col-span-1 text-center"},rl=["value"],dl={class:"col-span-1"},cl=["onClick"],il={class:"block"},ul={key:0,class:"uppercase"},pl={class:"col-span-4"},vl={class:"col-span-2 text-right"},ml={class:"block font-bold"},gl=K({__name:"payments",props:{month:{},locationId:{}},setup(P,{expose:D}){const l=r([]),f=r([]),g=r(""),v=P,s=r([]),p=r(""),$=r(!1),A=r(""),c=()=>{console.log("search"),g.value==""&&A.value==""?s.value=l.value:(console.log("filter"),s.value=l.value.filter(d=>{let _=!1;return g.value!=""&&(d.name.toLowerCase().includes(g.value.toLowerCase())&&(_=!0),d.room&&d.room.name.toLowerCase().includes(g.value.toLowerCase())&&(_=!0)),d.status==A.value&&(_=!0),_}))},b=async()=>{if(p.value==""){R({type:"error",title:"Error",text:"Select payment method"});return}try{$.value=!0,await F.put("/payment/paid",{ids:f.value,paymentMethod:p.value}),f.value=[],p.value="",n(),R({type:"success",title:"Success",text:"Payments updated"})}catch(d){console.error(d),R({type:"error",title:"Error",text:"Error updating payments"})}finally{$.value=!1}},x=()=>{f.value.length==s.value.length?f.value=[]:f.value=s.value.map(d=>d._id)},m=X(()=>l.value.reduce((d,_)=>d+_.amount,0)),u=X(()=>l.value.filter(d=>d.status!=="paid").reduce((d,_)=>d+_.amount,0)),a=X(()=>l.value.filter(d=>d.status=="paid").reduce((d,_)=>d+_.amount,0)),n=async()=>{try{const d=await F.get(`/payment?location=${v.locationId}&month=${v.month}`);l.value=d.data,c()}catch(d){console.error(d),R({type:"error",title:"Error",text:"Error loading payments"})}},I=()=>{const{open:d,close:_}=J({component:ge,attrs:{locationId:v.locationId,month:v.month,onConfirm(q){n(),console.log("onConfirm",q),_()},onClose(){_()}}});d()},C=d=>{const{open:_,close:q}=J({component:ge,attrs:{locationId:v.locationId,month:v.month,id:d,onConfirm(i){n(),console.log("onConfirm",i),q()},onClose(){q()}}});_()};return le(()=>{}),se(()=>A.value,()=>{c()}),se(()=>g.value,()=>{A.value==""&&c()}),se(()=>v.month,()=>{n()}),D({load:n}),(d,_)=>{const q=ee("Loading");return M(),N(Q,null,[Z(q,{visible:$.value},null,8,["visible"]),e("div",Ao,[Ro,e("div",{class:"col-span-2"},[e("button",{class:"bg-blue-500 text-white px-5 py-1 rounded float-right w-full",onClick:I}," AGREGAR ")]),Oo,e("div",Io,[e("h1",Mo," PAGOS DE "+k(j(H)(d.month,"YY-MM").format("MMMM [de] YY")),1)]),e("div",Fo,[e("strong",null,"$"+k(j(V)(m.value)),1),e("strong",So,"$"+k(j(V)(a.value)),1),e("strong",To,"$"+k(j(V)(u.value)),1)]),e("div",No,[Uo,w(e("input",{type:"text",class:"w-full p-1.5 border-gray-300 rounded",placeholder:"Buscar gasto","onUpdate:modelValue":_[0]||(_[0]=i=>g.value=i),onKeyup:fe(c,["enter"])},null,40,Do),[[S,g.value]])]),e("div",Lo,[Po,w(e("select",{class:"w-full p-1.5 border-gray-300 rounded","onUpdate:modelValue":_[1]||(_[1]=i=>A.value=i)},zo,512),[[de,A.value]])]),f.value.length>0?(M(),N("div",Bo,[e("div",jo,[e("div",qo,[Ho,w(e("select",{"onUpdate:modelValue":_[2]||(_[2]=i=>p.value=i),class:O(["w-full p-1.5 border-gray-300 rounded",{"border-red-500":f.value.length>0&&p.value==""}])},Xo,2),[[de,p.value]])]),e("div",Qo,[e("button",{class:O(["text-white px-5 py-1.5 rounded float-right w-full",{"bg-gray-500":f.value.length==0,"bg-green-500":f.value.length>0}]),onClick:b,disabled:f.value.length==0}," MARCAR COMO PAGADO ",10,el)])])])):W("",!0),e("div",{class:"col-span-12 mt-2"},[e("div",{class:"grid grid-cols-12 gap-x-4 border-b items-center font-bold bg-slate-500 text-white px-2"},[e("div",{class:"col-span-1 text-center"},[e("small",{class:"cursor-pointer hover:underline",onClick:x},"SELEC TODOS")]),tl])]),e("div",ol,[s.value.length==0?(M(),N("div",ll,al)):W("",!0),(M(!0),N(Q,null,oe(s.value,i=>(M(),N("div",{class:O(["grid grid-cols-12 gap-4 gap-x-3 gap border-b items-center px-2 hover:bg-gray-200 cursor-pointer1",{"bg-gray-100":l.value.indexOf(i)%2===0,"bg-yellow-100":i.status==="pending"}]),key:i.id},[e("div",nl,[w(e("input",{type:"checkbox",class:"form-checkbox h-5 w-5 text-blue-600 mx-auto","onUpdate:modelValue":_[3]||(_[3]=T=>f.value=T),value:i._id},null,8,rl),[[pe,f.value]])]),e("div",dl,[e("small",null,k(j(we)(i.createdAt,"DD-MM")),1)]),e("div",{class:"col-span-4",onClick:T=>C(i._id)},[e("strong",il,k(i.name),1),i.room?(M(),N("small",ul,k(i.room&&i.room.name),1)):W("",!0)],8,cl),e("div",pl,k(i.category),1),e("div",vl,[e("small",null,k(i.paymentMethod),1),e("span",ml,"$"+k(j(V)(i.amount)),1)])],2))),128))])])],64)}}}),hl={class:"grid grid-cols-6 gap-2"},_l=e("div",{class:"col-span-6 mt-5"},[e("span",{class:"font-bold"},"DATOS DEL PROPIETARIO")],-1),bl={class:"col-span-2"},yl=e("small",null,"IDENTIFICADOR",-1),fl={class:"col-span-4"},$l=e("small",null,"NOMBRE",-1),xl={class:"col-span-4"},wl=e("small",null,"DIRECCION",-1),Cl={class:"col-span-2"},El=e("small",null,"COMUNA",-1),kl={class:"col-span-3"},Al=e("small",null,"REGION",-1),Rl={class:"col-span-3"},Ol=e("small",null,"TELEFONO",-1),Il={class:"col-span-6"},Ml=e("small",null,"CORREO",-1),Fl={class:"col-span-6"},Sl=e("small",null,"NOTAS",-1),Tl=e("div",{class:"col-span-6 py-2"},null,-1),Nl={class:"col-span-1"},Ul=K({__name:"ownerModal",props:{locationId:{}},emits:["close","confirm"],setup(P,{emit:D}){const l=D,f=r(""),g=r(""),v=r(""),s=r(""),p=r(""),$=r(""),A=r(""),c=r(""),b=r(""),x=async()=>{try{const{data:u}=await F.get(`/owner/rut/${v.value}`);if(u==null)return R({type:"info",title:"No existe",text:"Propietario no encontrado en la base de datos"});f.value=u._id,g.value=u.name,s.value=u.address,p.value=u.city,$.value=u.region,A.value=u.phone,c.value=u.email,b.value=u.notes}catch(u){console.log(u),R({type:"error",title:"Error",text:"Error loading owner"})}},m=async()=>{try{let u;f.value?u=await F.put(`/owner/${f.value}`,{name:g.value,rut:v.value,address:s.value,city:p.value,region:$.value,phone:A.value,email:c.value,notes:b.value}):u=await F.post("/owner",{name:g.value,rut:v.value,address:s.value,city:p.value,region:$.value,phone:A.value,email:c.value,notes:b.value}),g.value="",v.value="",s.value="",p.value="",$.value="",A.value="",c.value="",b.value="",l("confirm",u.data),R({type:"success",title:"Success",text:"Propietario creado"})}catch(u){console.log(u),R({type:"error",title:"Error",text:"Error saving payment"})}};return(u,a)=>(M(),te(j(ne),{class:"flex justify-center items-center w-full h-full","content-class":"flex flex-col max-w-xl mx-4 p-4 bg-white border dark:border-gray-700 rounded-lg space-y-2"},{default:ae(()=>[e("div",hl,[_l,e("div",bl,[yl,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":v.value.length>=0&&v.value.length<9}]),placeholder:"RUT","onUpdate:modelValue":a[0]||(a[0]=n=>v.value=n),onBlur:x},null,34),[[S,v.value]])]),e("div",fl,[$l,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":g.value.length>=0&&g.value.length<3}]),placeholder:"Nombre","onUpdate:modelValue":a[1]||(a[1]=n=>g.value=n)},null,2),[[S,g.value]])]),e("div",xl,[wl,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":s.value.length>=0&&s.value.length<3}]),placeholder:"Calle 1234","onUpdate:modelValue":a[2]||(a[2]=n=>s.value=n)},null,2),[[S,s.value]])]),e("div",Cl,[El,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":p.value.length>=0&&p.value.length<3}]),placeholder:"Comuna","onUpdate:modelValue":a[3]||(a[3]=n=>p.value=n)},null,2),[[S,p.value]])]),e("div",kl,[Al,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":$.value.length>=0&&$.value.length<3}]),placeholder:"Region","onUpdate:modelValue":a[4]||(a[4]=n=>$.value=n)},null,2),[[S,$.value]])]),e("div",Rl,[Ol,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":A.value.length>=0&&A.value.length<9}]),placeholder:"Ej: 5698765432","onUpdate:modelValue":a[5]||(a[5]=n=>A.value=n)},null,2),[[S,A.value]])]),e("div",Il,[Ml,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":c.value.length>=0&&c.value.length<3}]),placeholder:"nombre@gmail.com","onUpdate:modelValue":a[6]||(a[6]=n=>c.value=n)},null,2),[[S,c.value]])]),e("div",Fl,[Sl,w(e("textarea",{class:"w-full p-2 border rounded",placeholder:"(Opcional)","onUpdate:modelValue":a[7]||(a[7]=n=>b.value=n)},null,512),[[S,b.value]])]),Tl,e("div",Nl,[e("button",{class:"w-full py-1.5 border rounded-lg bg-gray-600 text-white",onClick:a[8]||(a[8]=n=>u.$emit("close"))}," CERRAR ")]),e("div",{class:"col-span-5"},[e("button",{class:"w-full w-50 px-4 py-1.5 border rounded-lg bg-green-600 text-white",onClick:m}," GUARDAR ")])])]),_:1}))}}),Dl={class:"grid grid-cols-6 gap-2"},Ll=e("div",{class:"col-span-6 mt-5"},[e("span",{class:"font-bold"},"DATOS DEL RESIDENTE")],-1),Pl={class:"col-span-2"},Vl=e("small",null,"IDENTIFICADOR",-1),Gl={class:"col-span-4"},Yl=e("small",null,"NOMBRE",-1),zl={class:"col-span-4"},Bl=e("small",null,"DIRECCION",-1),jl={class:"col-span-2"},ql=e("small",null,"COMUNA",-1),Hl={class:"col-span-3"},Wl=e("small",null,"REGION",-1),Kl={class:"col-span-3"},Zl=e("small",null,"TELEFONO",-1),Jl={class:"col-span-6"},Xl=e("small",null,"CORREO",-1),Ql={class:"col-span-6"},es=e("small",null,"NOTAS",-1),ts=e("div",{class:"col-span-6 py-2"},null,-1),os={class:"col-span-1"},ls=K({__name:"residentModal",props:{locationId:{}},emits:["close","confirm"],setup(P,{emit:D}){const l=D,f=r(""),g=r(""),v=r(""),s=r(""),p=r(""),$=r(""),A=r(""),c=r(""),b=r(""),x=async()=>{try{const{data:u}=await F.get(`/resident/rut/${v.value}`);if(u==null)return R({type:"info",title:"No existe",text:"Propietario no encontrado en la base de datos"});f.value=u._id,g.value=u.name,s.value=u.address,p.value=u.city,$.value=u.region,A.value=u.phone,c.value=u.email,b.value=u.notes}catch(u){console.log(u),R({type:"error",title:"Error",text:"Error loading owner"})}},m=async()=>{try{let u;f.value?u=await F.put(`/resident/${f.value}`,{name:g.value,rut:v.value,address:s.value,city:p.value,region:$.value,phone:A.value,email:c.value,notes:b.value}):u=await F.post("/resident",{name:g.value,rut:v.value,address:s.value,city:p.value,region:$.value,phone:A.value,email:c.value,notes:b.value}),g.value="",v.value="",s.value="",p.value="",$.value="",A.value="",c.value="",b.value="",l("confirm",u.data),R({type:"success",title:"Success",text:"Residente creado"})}catch(u){console.log(u),R({type:"error",title:"Error",text:"Error saving"})}};return(u,a)=>(M(),te(j(ne),{class:"flex justify-center items-center w-full h-full","content-class":"flex flex-col max-w-xl mx-4 p-4 bg-white border dark:border-gray-700 rounded-lg space-y-2"},{default:ae(()=>[e("div",Dl,[Ll,e("div",Pl,[Vl,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":v.value.length>=0&&v.value.length<9}]),placeholder:"RUT","onUpdate:modelValue":a[0]||(a[0]=n=>v.value=n),onBlur:x},null,34),[[S,v.value]])]),e("div",Gl,[Yl,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":g.value.length>=0&&g.value.length<3}]),placeholder:"Nombre","onUpdate:modelValue":a[1]||(a[1]=n=>g.value=n)},null,2),[[S,g.value]])]),e("div",zl,[Bl,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":s.value.length>=0&&s.value.length<3}]),placeholder:"Calle 1234","onUpdate:modelValue":a[2]||(a[2]=n=>s.value=n)},null,2),[[S,s.value]])]),e("div",jl,[ql,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":p.value.length>=0&&p.value.length<3}]),placeholder:"Comuna","onUpdate:modelValue":a[3]||(a[3]=n=>p.value=n)},null,2),[[S,p.value]])]),e("div",Hl,[Wl,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":$.value.length>=0&&$.value.length<3}]),placeholder:"Region","onUpdate:modelValue":a[4]||(a[4]=n=>$.value=n)},null,2),[[S,$.value]])]),e("div",Kl,[Zl,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":A.value.length>=0&&A.value.length<9}]),placeholder:"Ej: 5698765432","onUpdate:modelValue":a[5]||(a[5]=n=>A.value=n)},null,2),[[S,A.value]])]),e("div",Jl,[Xl,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500":c.value.length>=0&&c.value.length<3}]),placeholder:"nombre@gmail.com","onUpdate:modelValue":a[6]||(a[6]=n=>c.value=n)},null,2),[[S,c.value]])]),e("div",Ql,[es,w(e("textarea",{class:"w-full p-2 border rounded",placeholder:"(Opcional)","onUpdate:modelValue":a[7]||(a[7]=n=>b.value=n)},null,512),[[S,b.value]])]),ts,e("div",os,[e("button",{class:"w-full py-1.5 border rounded-lg bg-gray-600 text-white",onClick:a[8]||(a[8]=n=>u.$emit("close"))}," CERRAR ")]),e("div",{class:"col-span-5"},[e("button",{class:"w-full w-50 px-4 py-1.5 border rounded-lg bg-green-600 text-white",onClick:m}," GUARDAR ")])])]),_:1}))}}),ss={class:"grid grid-cols-6 gap-x-2"},as={class:"col-span-6 mt-5"},ns={class:"font-bold text-xl"},rs=e("div",{class:"col-span-6 mt-5"},[e("span",{class:"font-bold"},"DATOS RESIDENTE")],-1),ds={class:"col-span-5"},cs=e("small",null,"NOMBRE",-1),is=["value"],us=e("svg",{baseProfile:"tiny",height:"24px",version:"1.2",viewBox:"0 0 24 24",width:"24px",class:"mx-auto","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[e("path",{d:"M9.387,17.548l0.371,1.482C9.891,19.563,10.45,20,11,20h1c0.55,0,1.109-0.437,1.242-0.97l0.371-1.482  c0.133-0.533,0.675-0.846,1.203-0.694l1.467,0.42c0.529,0.151,1.188-0.114,1.462-0.591l0.5-0.867  c0.274-0.477,0.177-1.179-0.219-1.562l-1.098-1.061c-0.396-0.383-0.396-1.008,0.001-1.39l1.096-1.061  c0.396-0.382,0.494-1.084,0.22-1.561l-0.501-0.867c-0.275-0.477-0.933-0.742-1.461-0.591l-1.467,0.42  c-0.529,0.151-1.07-0.161-1.204-0.694l-0.37-1.48C13.109,5.437,12.55,5,12,5h-1c-0.55,0-1.109,0.437-1.242,0.97l-0.37,1.48  C9.254,7.983,8.713,8.296,8.184,8.145l-1.467-0.42C6.188,7.573,5.529,7.839,5.255,8.315l-0.5,0.867  c-0.274,0.477-0.177,1.179,0.22,1.562l1.096,1.059c0.395,0.383,0.395,1.008,0,1.391l-1.098,1.061  c-0.395,0.383-0.494,1.085-0.219,1.562l0.501,0.867c0.274,0.477,0.933,0.742,1.462,0.591l1.467-0.42  C8.712,16.702,9.254,17.015,9.387,17.548z M11.5,10.5c1.104,0,2,0.895,2,2c0,1.104-0.896,2-2,2s-2-0.896-2-2  C9.5,11.395,10.396,10.5,11.5,10.5z"})],-1),ps=[us],vs={class:"col-span-3"},ms=e("small",null,"TELEFONO",-1),gs=["value"],hs={class:"col-span-3"},_s=e("small",null,"CORREO",-1),bs=["value"],ys=e("div",{class:"col-span-6 mt-5"},[e("span",{class:"font-bold"},"DATOS PROPIETARIO")],-1),fs={class:"col-span-5"},$s=["value"],xs=e("svg",{baseProfile:"tiny",height:"24px",version:"1.2",viewBox:"0 0 24 24",width:"24px",class:"mx-auto","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[e("path",{d:"M9.387,17.548l0.371,1.482C9.891,19.563,10.45,20,11,20h1c0.55,0,1.109-0.437,1.242-0.97l0.371-1.482  c0.133-0.533,0.675-0.846,1.203-0.694l1.467,0.42c0.529,0.151,1.188-0.114,1.462-0.591l0.5-0.867  c0.274-0.477,0.177-1.179-0.219-1.562l-1.098-1.061c-0.396-0.383-0.396-1.008,0.001-1.39l1.096-1.061  c0.396-0.382,0.494-1.084,0.22-1.561l-0.501-0.867c-0.275-0.477-0.933-0.742-1.461-0.591l-1.467,0.42  c-0.529,0.151-1.07-0.161-1.204-0.694l-0.37-1.48C13.109,5.437,12.55,5,12,5h-1c-0.55,0-1.109,0.437-1.242,0.97l-0.37,1.48  C9.254,7.983,8.713,8.296,8.184,8.145l-1.467-0.42C6.188,7.573,5.529,7.839,5.255,8.315l-0.5,0.867  c-0.274,0.477-0.177,1.179,0.22,1.562l1.096,1.059c0.395,0.383,0.395,1.008,0,1.391l-1.098,1.061  c-0.395,0.383-0.494,1.085-0.219,1.562l0.501,0.867c0.274,0.477,0.933,0.742,1.462,0.591l1.467-0.42  C8.712,16.702,9.254,17.015,9.387,17.548z M11.5,10.5c1.104,0,2,0.895,2,2c0,1.104-0.896,2-2,2s-2-0.896-2-2  C9.5,11.395,10.396,10.5,11.5,10.5z"})],-1),ws=[xs],Cs={class:"col-span-3"},Es=e("small",null,"TELEFONO",-1),ks=["value"],As={class:"col-span-3"},Rs=e("small",null,"CORREO",-1),Os=["value"],Is=e("div",{class:"col-span-6 mt-5"},[e("span",{class:"font-bold"},"INFORMACION GENERAL")],-1),Ms={class:"col-span-3"},Fs=e("small",null,"NUMERO",-1),Ss={class:"col-span-3"},Ts=e("small",null,"ROL",-1),Ns={class:"col-span-3"},Us=e("small",null,"Metros cuadrados",-1),Ds={class:"col-span-3"},Ls=e("small",null,"PORCENTAJE PRORRATEO",-1),Ps={class:"col-span-3"},Vs=e("small",null,"VALOR EXTRA",-1),Gs={class:"col-span-3"},Ys=e("small",null,"VALOR TOTAL",-1),zs=e("div",{class:"col-span-6 mt-5"},[e("span",{class:"font-bold"},"CONTRATO")],-1),Bs={class:"col-span-3"},js=e("small",null,"INICIO CONTRATACION",-1),qs={class:"col-span-3"},Hs=e("small",null,"FIN CONTRATACION",-1),Ws=e("div",{class:"col-span-6 py-2"},null,-1),Ks={class:"col-span-1"},Zs=K({__name:"configModal",props:{locationId:{},id:{}},emits:["close","confirm"],setup(P,{emit:D}){const l=P,f=D,g=r(""),v=r(""),s=r(""),p=r(""),$=r(""),A=r(!0),c=r(0),b=r(0),x=r(""),m=r(""),u=r({name:"",phone:"",rut:"",email:"",notes:"",_id:null}),a=r({name:"",phone:"",rut:"",email:"",notes:"",_id:null}),n=r({name:"",address:"",city:"",region:"",zip:"",phone:"",email:"",notes:"",totalm2:0,recaudation:0}),I=()=>{console.log("showOwnerModal");const{open:i,close:T}=J({component:Ul,attrs:{locationId:l.locationId,onConfirm(t){console.log("onConfirm",t),u.value=t,T()},onClose(){T()}}});i()},C=()=>{console.log("showResidentModal");const{open:i,close:T}=J({component:ls,attrs:{locationId:l.locationId,onConfirm(t){console.log("onConfirm",t),a.value=t,T()},onClose(){T()}}});i()},d=async()=>{var i,T;try{A.value=!0;let t={number:v.value,rolNumber:s.value,m2:p.value,proration:$.value,owner:(i=u.value)==null?void 0:i._id,resident:(T=a.value)==null?void 0:T._id,value:c.value,extra:b.value};x.value&&(t.startAt=H(x.value).toDate()),m.value&&(t.endAt=H(m.value).toDate()),await F.put(`/location/${l.locationId}/room/${l.id}`,t),R({type:"success",title:"Guardado",text:"Se ha guardado la configuraci\xF3n"}),f("confirm")}catch{R({type:"error",title:"Error",text:"Ha ocurrido un error al guardar la configuraci\xF3n"})}finally{A.value=!1}},_=async()=>{try{A.value=!0;const{data:i}=await F.get(`/location/${l.locationId}/room/${l.id}`);i.name&&(g.value=i.name),i.number&&(v.value=i.number),i.rolNumber&&(s.value=i.rolNumber),i.m2&&(p.value=i.m2),i.proration&&($.value=i.proration),i.value&&(c.value=i.value),i.extra&&(b.value=i.extra),i.startAt&&(x.value=H(i.startAt).format("YYYY-MM-DD")),i.endAt&&(m.value=i.endAt),i.owner&&(u.value=i.owner),i.resident&&(a.value=i.resident),q()}catch{R({type:"error",title:"Error",text:"Error loading room"})}finally{A.value=!1}},q=async()=>{try{const{data:i}=await F.get(`/location/${l.locationId}`);n.value=i}catch{R({type:"error",title:"Error",text:"Error loading location"})}};return se([p,n,b],([i])=>{if(!n.value.totalm2)return;console.log("watch");const T=(n.value.recaudation/n.value.totalm2).toFixed(2);console.log({valuem2:T,newM2:i,value:parseFloat(T)*parseFloat(i),proration:parseInt(parseFloat(i)/n.value.totalm2*1e4)/100}),c.value=Math.round(parseFloat(T)*parseFloat(i))+b.value,$.value=parseInt(parseFloat(i)/n.value.totalm2*1e4)/100}),le(()=>{console.log({props:l}),_()}),(i,T)=>{const t=ee("Loading");return M(),te(j(ne),{class:"flex justify-center items-center w-full h-full","content-class":"flex flex-col max-w-3xl mx-4 p-4 bg-white border dark:border-gray-700 rounded-lg space-y-2 overflow-y-scroll max-h-[90vh]"},{default:ae(()=>[Z(t,{visible:A.value},null,8,["visible"]),e("div",ss,[e("div",as,[e("span",ns,k(g.value),1)]),rs,e("div",ds,[cs,e("input",{type:"text",class:O(["w-full p-2 border rounded bg-gray-200 cursor-not-allowed",{"border-red-500 bg-red-100":a.value._id===""}]),placeholder:"Nombre",disabled:"",value:`${a.value.rut} - ${a.value.name}`},null,10,is)]),e("div",{class:"col-span-1 self-end"},[e("button",{onClick:C,class:"block py-2 w-full border rounded bg-gray-200 text-white"},ps)]),e("div",vs,[ms,e("input",{type:"text",class:O(["w-full p-2 border rounded bg-gray-200 cursor-not-allowed",{"border-red-500 bg-red-100":a.value._id===""}]),placeholder:"Nombre",disabled:"",value:`${a.value.phone}`},null,10,gs)]),e("div",hs,[_s,e("input",{type:"text",class:O(["w-full p-2 border rounded bg-gray-200 cursor-not-allowed",{"border-red-500 bg-red-100":a.value._id===""}]),placeholder:"Nombre",disabled:"",value:`${a.value.email}`},null,10,bs)]),ys,e("div",fs,[e("input",{type:"text",class:O(["w-full p-2 border rounded bg-gray-200 cursor-not-allowed",{"border-red-500 bg-red-100":u.value._id===""}]),placeholder:"Nombre",disabled:"",value:`${u.value.rut} - ${u.value.name}`},null,10,$s)]),e("div",{class:"col-span-1 self-end"},[e("button",{onClick:I,class:"block py-2 w-full border rounded bg-gray-200 text-white"},ws)]),e("div",Cs,[Es,e("input",{type:"text",class:O(["w-full p-2 border rounded bg-gray-200 cursor-not-allowed",{"border-red-500 bg-red-100":u.value._id===""}]),disabled:"",value:`${u.value.phone}`},null,10,ks)]),e("div",As,[Rs,e("input",{type:"text",class:O(["w-full p-2 border rounded bg-gray-200 cursor-not-allowed",{"border-red-500 bg-red-100":u.value._id===""}]),disabled:"",value:`${u.value.email}`},null,10,Os)]),Is,e("div",Ms,[Fs,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500 bg-red-100":v.value===""}]),placeholder:"Ej: 1","onUpdate:modelValue":T[0]||(T[0]=o=>v.value=o)},null,2),[[S,v.value,void 0,{number:!0}]])]),e("div",Ss,[Ts,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500 bg-red-100":s.value===""}]),placeholder:"Nombre","onUpdate:modelValue":T[1]||(T[1]=o=>s.value=o)},null,2),[[S,s.value]])]),e("div",Ns,[Us,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500 bg-red-100":p.value===""}]),placeholder:"Metros cuadrados","onUpdate:modelValue":T[2]||(T[2]=o=>p.value=o)},null,2),[[S,p.value,void 0,{number:!0}]])]),e("div",Ds,[Ls,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500 bg-red-100":$.value===""}]),placeholder:"Porcentaje Prorrateo","onUpdate:modelValue":T[3]||(T[3]=o=>$.value=o)},null,2),[[S,$.value,void 0,{number:!0}]])]),e("div",Ps,[Vs,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{}]),placeholder:"Valor extra","onUpdate:modelValue":T[4]||(T[4]=o=>b.value=o)},null,512),[[S,b.value,void 0,{number:!0}]])]),e("div",Gs,[Ys,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500 bg-red-100":c.value===""}]),placeholder:"Porcentaje Prorrateo","onUpdate:modelValue":T[5]||(T[5]=o=>c.value=o)},null,2),[[S,c.value,void 0,{number:!0}]])]),zs,e("div",Bs,[js,w(e("input",{type:"date",class:"w-full p-2 border rounded","onUpdate:modelValue":T[6]||(T[6]=o=>x.value=o)},null,512),[[S,x.value]])]),e("div",qs,[Hs,w(e("input",{type:"date",class:"w-full p-2 border rounded","onUpdate:modelValue":T[7]||(T[7]=o=>m.value=o)},null,512),[[S,m.value]])]),Ws,e("div",Ks,[e("button",{class:"w-full py-1.5 border rounded-lg bg-gray-600 text-white",onClick:T[8]||(T[8]=o=>i.$emit("close"))}," CERRAR ")]),e("div",{class:"col-span-5"},[e("button",{class:"w-full w-50 px-4 py-1.5 border rounded-lg bg-green-600 text-white",onClick:d}," GUARDAR ")])])]),_:1})}}}),Js={class:"grid grid-cols-6 gap-x-2"},Xs={class:"col-span-6 mt-5"},Qs={class:"font-bold"},ea={key:0,class:"col-span-6"},ta=e("small",null,"UBICACIONES",-1),oa={class:"overflow-scroll h-[280px]"},la={key:0,class:"py-20 mt-10"},sa={class:"grid grid-cols-12"},aa={class:"col-span-12 ml-auto"},na=["onClick"],ra=e("div",{class:"col-span-12"},null,-1),da=["value"],ca={class:"col-span-6"},ia=e("small",null,"MEDIDA",-1),ua=e("div",{class:"col-span-6 py-2"},null,-1),pa={class:"col-span-1"},va={key:1,class:"col-span-5"},ma={key:2,class:"col-span-5"},ye=K({__name:"configureWaterModal",props:{locationId:{},id:{},month:{},multiple:{type:Boolean}},emits:["close","confirm"],setup(P,{emit:D}){const l=P,f=D,g=r(""),v=r(""),s=r([]),p=r(!1),$=r([]);r({name:"",address:"",city:"",region:"",zip:"",phone:"",email:"",notes:"",totalm2:0,recaudation:0});const A=async()=>{try{p.value=!0,await F.post("/room/water",{value:v.value,month:l.month,rooms:s.value,location:l.locationId}),R({type:"success",title:"Guardado",text:"Se ha guardado la configuraci\xF3n"}),f("confirm")}catch{R({type:"error",title:"Error",text:"Ha ocurrido un error al guardar la configuraci\xF3n"})}finally{p.value=!1}},c=async()=>{try{p.value=!0,g.value?await F.put(`/location/${l.locationId}/room/${l.id}/water/${g.value}`,{value:v.value,month:l.month}):await F.post(`/location/${l.locationId}/room/${l.id}/water`,{value:v.value,month:l.month}),R({type:"success",title:"Guardado",text:"Se ha guardado la configuraci\xF3n"}),f("confirm")}catch{R({type:"error",title:"Error",text:"Ha ocurrido un error al guardar la configuraci\xF3n"})}finally{p.value=!1}},b=a=>{s.value=s.value.concat(a.rooms.map(n=>n._id))},x=()=>{const a=$.value.map(n=>n.rooms).flat();s.value.length===a.length?s.value=[]:s.value=a.map(n=>n._id),console.log("selected",s.value)},m=async()=>{try{p.value=!0;const{data:a}=await F.get(`/location/${l.locationId}/room/${l.id}/water?month=${l.month}`);if(a===null)return;g.value=a._id,v.value=a.value}catch{R({type:"error",title:"Error",text:"Error cargando agua"}),f("close")}finally{p.value=!1}},u=async()=>{try{p.value=!0;const{data:a}=await F.get(`/location/${l.locationId}`);$.value=a.floors.map(n=>({rooms:n.rooms,name:n.name}))}catch{R({type:"error",title:"Error",text:"Error loading rooms"})}finally{p.value=!1}};return le(()=>{console.log({props:l}),l.id&&m(),l.multiple&&u()}),(a,n)=>{const I=ee("Loading"),C=ee("loading-spin");return M(),te(j(ne),{class:"flex justify-center items-center w-full h-full","content-class":"flex flex-col max-w-3xl mx-4 p-4 bg-white border dark:border-gray-700 rounded-lg space-y-2 overflow-y-scroll max-h-[90vh]"},{default:ae(()=>[Z(I,{visible:p.value},null,8,["visible"]),e("div",Js,[e("div",Xs,[e("span",Qs,"INFORMACION DEL "+k(a.month),1)]),l.multiple?(M(),N("div",ea,[ta,e("button",{onClick:x,class:"px-2 py-0.5 border rounded bg-gray-600 text-white"}," Seleccionar todo "),e("div",oa,[p.value?(M(),N("div",la,[Z(C)])):W("",!0),(M(!0),N(Q,null,oe($.value,d=>(M(),N("div",{key:d._id},[e("div",sa,[e("div",aa,[e("button",{onClick:_=>b(d),class:"px-2 py-0.5 border rounded bg-gray-600 text-white"}," Seleccionar piso ",8,na)]),ra,(M(!0),N(Q,null,oe(d.rooms,_=>(M(),N("div",{class:"col-span-4 items-center border",key:_._id},[e("span",null,[w(e("input",{type:"checkbox",value:_._id,"onUpdate:modelValue":n[0]||(n[0]=q=>s.value=q)},null,8,da),[[pe,s.value]]),ce(" "+k(_.name),1)])]))),128))])]))),128))])])):W("",!0),e("div",ca,[ia,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500 bg-red-100":v.value===""}]),placeholder:"Ej: 1","onUpdate:modelValue":n[1]||(n[1]=d=>v.value=d)},null,2),[[S,v.value,void 0,{number:!0}]])]),ua,e("div",pa,[e("button",{class:"w-full py-1.5 px-4 border rounded-lg bg-gray-600 text-white",onClick:n[2]||(n[2]=d=>a.$emit("close"))}," CERRAR ")]),l.multiple?(M(),N("div",ma,[e("button",{class:"w-full w-50 px-4 py-1.5 border rounded-lg bg-green-600 text-white",onClick:A}," GUARDAR TODOS ")])):(M(),N("div",va,[e("button",{class:"w-full w-50 px-4 py-1.5 border rounded-lg bg-green-600 text-white",onClick:c}," GUARDAR ")]))])]),_:1})}}}),ga={class:"grid grid-cols-6 gap-x-2"},ha=e("div",{class:"col-span-6 mt-5"},[e("span",{class:"font-bold"},"INFORMACION")],-1),_a={class:"col-span-6"},ba=e("small",null,"NOMBRE",-1),ya={class:"col-span-6"},fa=e("small",null,"MONTO",-1),$a={class:"col-span-6"},xa=e("small",null,"NOTAS",-1),wa=e("div",{class:"col-span-6 py-2"},null,-1),Ca={class:"col-span-1"};K({__name:"penaltyFeeModal",props:{locationId:{},id:{}},emits:["close","confirm"],setup(P,{emit:D}){const l=P,f=D;r("");const g=r(""),v=r(""),s=r(""),p=r(!1),$=r(null),A=r({name:"",address:"",city:"",region:"",zip:"",phone:"",email:"",notes:"",totalm2:0,recaudation:0}),c=async()=>{try{p.value=!0,await F.post("/penaltyfee",{name:g.value,amount:s.value,location:l.locationId,room:l.id,notes:v.value}),R({type:"success",title:"Guardado",text:"Se ha guardado"}),f("confirm")}catch{R({type:"error",title:"Error",text:"Ha ocurrido un error al guardar"})}finally{p.value=!1}},b=async()=>{try{const{data:x}=await F.get(`/location/${l.locationId}`);A.value=x}catch{R({type:"error",title:"Error",text:"Error loading location"})}};return le(()=>{console.log({props:l}),b(),setTimeout(()=>{$.value&&$.value.focus()},500)}),(x,m)=>{const u=ee("Loading");return M(),te(j(ne),{class:"flex justify-center items-center w-full h-full","content-class":"flex flex-col max-w-3xl mx-4 p-4 bg-white border dark:border-gray-700 rounded-lg space-y-2 overflow-y-scroll max-h-[90vh]"},{default:ae(()=>[p.value?(M(),te(u,{key:0})):W("",!0),e("div",ga,[ha,e("div",_a,[ba,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500 bg-red-100":g.value===""}]),placeholder:"Ej: 1","onUpdate:modelValue":m[0]||(m[0]=a=>g.value=a),ref_key:"nameRef",ref:$},null,2),[[S,g.value,void 0,{number:!0}]])]),e("div",ya,[fa,w(e("input",{type:"text",class:O(["w-full p-2 border rounded",{"border-red-500 bg-red-100":s.value===""}]),placeholder:"Ej: 1","onUpdate:modelValue":m[1]||(m[1]=a=>s.value=a)},null,2),[[S,s.value,void 0,{number:!0}]])]),e("div",$a,[xa,w(e("textarea",{class:"w-full p-2 border rounded",placeholder:"(Opcional)","onUpdate:modelValue":m[2]||(m[2]=a=>v.value=a)},null,512),[[S,v.value,void 0,{number:!0}]])]),wa,e("div",Ca,[e("button",{class:"w-full py-1.5 border rounded-lg bg-gray-600 text-white",onClick:m[3]||(m[3]=a=>x.$emit("close"))}," CERRAR ")]),e("div",{class:"col-span-5"},[e("button",{class:"w-full w-50 px-4 py-1.5 border rounded-lg bg-green-600 text-white",onClick:c}," GUARDAR ")])])]),_:1})}}});const Ea={class:"grid grid-cols-6 gap-x-2"},ka=e("div",{class:"col-span-6 mt-5"},[e("span",{class:"font-bold"},"INFORMACION DE MULTAS IMPAGAS")],-1),Aa={class:"col-span-6"},Ra={key:0,class:"grid grid-cols-12 p-1 items-center"},Oa=e("div",{class:"col-span-12 py-8 text-center"},"No hay informacion",-1),Ia=[Oa],Ma={class:"col-span-1"},Fa=["onUpdate:modelValue"],Sa={class:"col-span-8"},Ta={class:"block"},Na={class:"col-span-3 text-right"},Ua=e("div",{class:"col-span-4"},[e("strong",null,"TOTAL")],-1),Da={class:"col-span-2 text-right"},La=e("div",{class:"col-span-6 py-2"},null,-1),Pa={class:"col-span-1"},Va={class:"col-span-5"},Ga=["disabled"];K({__name:"penaltyFeeListModal",props:{locationId:{},id:{}},emits:["close","confirm"],setup(P,{emit:D}){const l=P;r("");const f=r([]);r(""),r(""),r("");const g=r(!1),v=X(()=>f.value.filter(x=>x.selected).length===0||p.value===0),s=r({name:"",address:"",city:"",region:"",zip:"",phone:"",email:"",notes:"",totalm2:0,recaudation:0}),p=X(()=>f.value.reduce((x,m)=>m.selected?x+m.amount:x,0)),$=async()=>{try{const x=f.value.filter(m=>m.selected);if(console.log({selected:x}),x.length===0){R({type:"error",title:"Error",text:"No hay multas seleccionadas"});return}if(p.value==0){R({type:"error",title:"Error",text:"El monto total no puede ser 0"});return}A()}catch{R({type:"error",title:"Error",text:"Error loading location"})}},A=()=>{const x=f.value.filter(a=>a.selected).map(a=>a._id),{open:m,close:u}=J({component:ge,attrs:{roomId:l.id,locationId:l.locationId,category:"Multas Otras",name:"Pago",amount:p.value,onConfirm(a){console.log("onConfirm",a),F.post("/penaltyfee/pay",{ids:x,room:l.id}).then(()=>{c()}),u()},onClose(){u()}}});m()},c=async()=>{try{g.value=!0;const{data:x}=await F.get(`/penaltyfee?room=${l.id}`);f.value=x}catch{R({type:"error",title:"Error",text:"Error loading room"})}finally{g.value=!1}},b=async()=>{try{const{data:x}=await F.get(`/location/${l.locationId}`);s.value=x}catch{R({type:"error",title:"Error",text:"Error loading location"})}};return le(()=>{console.log({props:l}),c(),b()}),(x,m)=>{const u=ee("Loading");return M(),te(j(ne),{class:"flex justify-center items-center w-full h-full","content-class":"flex flex-col max-w-3xl mx-4 p-4 bg-white border dark:border-gray-700 rounded-lg space-y-2 overflow-y-scroll max-h-[90vh]"},{default:ae(()=>[Z(u,{visible:g.value},null,8,["visible"]),e("div",Ea,[ka,e("div",Aa,[f.value.length==0?(M(),N("div",Ra,Ia)):W("",!0),(M(!0),N(Q,null,oe(f.value,a=>(M(),N("div",{class:"grid grid-cols-12 border p-1 items-center",key:a._id},[e("div",Ma,[w(e("input",{type:"checkbox","onUpdate:modelValue":n=>a.selected=n,class:"form-checkbox h-5 w-5 text-green-600"},null,8,Fa),[[pe,a.selected]])]),e("div",Sa,[e("strong",Ta,k(a.name),1),e("small",null,k(a.notes),1)]),e("div",Na," $"+k(j(V)(a.amount)),1)]))),128))]),Ua,e("div",Da,[e("strong",null,"$"+k(j(V)(p.value)),1)]),La,e("div",Pa,[e("button",{class:"w-full py-1.5 px-4 border rounded-lg bg-gray-600 text-white",onClick:m[0]||(m[0]=a=>x.$emit("close"))}," CERRAR ")]),e("div",Va,[e("button",{class:O(["w-full w-50 px-4 py-1.5 border rounded-lg bg-green-600 text-white",{"bg-gray-400":v.value}]),onClick:$,disabled:v.value}," PAGAR ",10,Ga)])])]),_:1})}}});const Ya={id:"accordion-collapse","data-accordion":"collapse"},za={class:"mb-4"},Ba={class:"grid grid-cols-12"},ja={class:"col-span-11"},qa={class:"col-span-1"},Ha=e("svg",{height:"24",viewBox:"0 0 512 512",width:"24",fill:"currentColor",class:"text-blue-500 h-8 w-8 p-1 mx-auto",xmlns:"http://www.w3.org/2000/svg"},[e("title"),e("path",{d:"M265.12,60.12a12,12,0,0,0-18.23,0C215.23,97.15,112,225.17,112,320c0,88.37,55.64,144,144,144s144-55.63,144-144C400,225.17,296.77,97.15,265.12,60.12ZM272,412a12,12,0,0,1-11.34-16,11.89,11.89,0,0,1,11.41-8A60.06,60.06,0,0,0,332,328.07a11.89,11.89,0,0,1,8-11.41A12,12,0,0,1,356,328,84.09,84.09,0,0,1,272,412Z"})],-1),Wa=[Ha],Ka=["id"],Za=["data-accordion-target","aria-controls"],Ja=e("svg",{"data-accordion-icon":"",class:"w-3 h-3 rotate-180 shrink-0","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 10 6"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5 5 1 1 5"})],-1),Xa=["id","aria-labelledby"],Qa={class:"p-5 border border-b-0 border-gray-200"},en={class:"col-span-12"},tn={class:"grid grid-cols-12 gap-4 mt-4"},on={class:"col-span-9"},ln={class:"block"},sn={class:"grid grid-cols-12 gap-4 mt-5"},an=["onClick"],nn={class:"grid grid-cols-8"},rn={class:"col-span-6"},dn={class:"text-lg font-bold"},cn=e("div",{class:"w-full"},null,-1),un={class:"grid grid-cols-3 border-t"},pn={class:"col-span-1"},vn={class:"col-span-2"},mn={class:"col-span-2"},gn=e("div",{class:"col-span-3 border-b"},null,-1),hn={class:"col-span-2 font-bold"},_n={class:"col-span-2 font-bold text-blue-500"},bn={class:"col-span-2 font-bold text-green-500"},yn={key:0,class:"col-span-3 mt-4"},fn={class:"border border-yellow-300 bg-yellow-200 text-center rounded py-0.5 relative"},$n=e("span",{class:"left-2 px-2 absolute font-bold"},"R",-1),xn={key:1,class:"col-span-3"},wn=e("div",{class:"col-span-3 mt-5"},[e("small",{class:"block text-blue-500"}," HISTORIAL PAGOS ")],-1),Cn={class:"col-span-1 hidden1 ml-auto space-y-1"},En=["onClick"],kn=e("svg",{viewBox:"0 0 576 512",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"text-green-500 p-1"},[e("path",{d:"M559 54.5C524.1 38.25 489.2 32 454.3 32C343.5 32 232.5 94.38 121.7 94.38c-27.79 0-55.57-4-83.36-13.75C35.21 79.5 32.06 79 29.03 79C13.5 79 0 92.38 0 110.8v317.4c0 12.62 6.525 24.5 16.99 29.38C51.86 473.8 86.85 480 121.7 480c110.8 0 221.7-62.38 332.6-62.38c27.79 0 55.57 4 83.36 13.75c3.15 1.125 6.301 1.625 9.338 1.625C562.5 433 576 419.6 576 401.1V83.88C576 71.25 569.5 59.38 559 54.5zM528 151.2C496.5 147.2 472 120.6 472 88c0-2.209 .4486-4.262 .6751-6.403C492 83.22 510.7 86.56 528 93.39V151.2zM208 256c0-53.02 35.82-96 79.1-96s79.1 42.98 79.1 96c0 53.02-35.82 96-79.1 96S208 309 208 256zM48 133.6C68.05 138.6 88.86 140.1 110.4 141.7C104.2 170.5 78.63 192 48 192V133.6zM48 360.8C79.53 364.8 104 391.4 104 424c0 2.207-.4486 4.262-.6751 6.403C83.95 428.8 65.35 425.4 48 418.6V360.8zM528 378.4c-20.05-5.02-40.85-7.4-62.44-8.139C471.8 341.5 497.4 320 528 320V378.4z"})],-1),An=[kn],Rn=["onClick"],On=e("svg",{height:"24",viewBox:"0 0 512 512",width:"24",fill:"currentColor",class:"text-blue-500 h-8 w-8 p-1",xmlns:"http://www.w3.org/2000/svg"},[e("title"),e("path",{d:"M265.12,60.12a12,12,0,0,0-18.23,0C215.23,97.15,112,225.17,112,320c0,88.37,55.64,144,144,144s144-55.63,144-144C400,225.17,296.77,97.15,265.12,60.12ZM272,412a12,12,0,0,1-11.34-16,11.89,11.89,0,0,1,11.41-8A60.06,60.06,0,0,0,332,328.07a11.89,11.89,0,0,1,8-11.41A12,12,0,0,1,356,328,84.09,84.09,0,0,1,272,412Z"})],-1),In=[On],Mn={class:"col-span-1 ml-auto"},Fn=["onClick"],Sn=e("svg",{baseProfile:"tiny",height:"22px",version:"1.2",viewBox:"0 0 24 24",width:"22px",fill:"currentColor",class:"text-gray-60 h-8 w-8 p-1","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[e("path",{d:"M9.387,17.548l0.371,1.482C9.891,19.563,10.45,20,11,20h1c0.55,0,1.109-0.437,1.242-0.97l0.371-1.482  c0.133-0.533,0.675-0.846,1.203-0.694l1.467,0.42c0.529,0.151,1.188-0.114,1.462-0.591l0.5-0.867  c0.274-0.477,0.177-1.179-0.219-1.562l-1.098-1.061c-0.396-0.383-0.396-1.008,0.001-1.39l1.096-1.061  c0.396-0.382,0.494-1.084,0.22-1.561l-0.501-0.867c-0.275-0.477-0.933-0.742-1.461-0.591l-1.467,0.42  c-0.529,0.151-1.07-0.161-1.204-0.694l-0.37-1.48C13.109,5.437,12.55,5,12,5h-1c-0.55,0-1.109,0.437-1.242,0.97l-0.37,1.48  C9.254,7.983,8.713,8.296,8.184,8.145l-1.467-0.42C6.188,7.573,5.529,7.839,5.255,8.315l-0.5,0.867  c-0.274,0.477-0.177,1.179,0.22,1.562l1.096,1.059c0.395,0.383,0.395,1.008,0,1.391l-1.098,1.061  c-0.395,0.383-0.494,1.085-0.219,1.562l0.501,0.867c0.274,0.477,0.933,0.742,1.462,0.591l1.467-0.42  C8.712,16.702,9.254,17.015,9.387,17.548z M11.5,10.5c1.104,0,2,0.895,2,2c0,1.104-0.896,2-2,2s-2-0.896-2-2  C9.5,11.395,10.396,10.5,11.5,10.5z"})],-1),Tn=[Sn],Nn=K({__name:"floorRooms",props:{floors:{},locationId:{},month:{},date:{},payments:{},waterlist:{}},emits:["close","update"],setup(P,{emit:D}){const l=P,f=D,g=r(""),v=r("");xe(()=>{me()});const s=n=>l.payments?l.payments.filter(I=>I.room?I.room._id===n:!1).reduce((I,C)=>I+C.amount,0):0,p=n=>l.waterlist?l.waterlist.filter(I=>I.room?I.room===n:!1).reduce((I,C)=>I+C.value,0):0,$=n=>{const{open:I,close:C}=J({component:ge,attrs:{roomId:n,locationId:l.locationId,month:l.month,onConfirm(d){console.log("onConfirm",d),f("update"),C()},onClose(){C()}}});I()},A=X(()=>{if(!g.value)return l.floors;const n=g.value.toLowerCase().trim();return l.floors.map(I=>({...I,rooms:I.rooms.filter(C=>C.name.toLowerCase().includes(n))}))}),c=n=>n.rooms?n.rooms.reduce((I,C)=>I+(C.m2||0),0).toFixed(2):0,b=n=>n.rooms?n.rooms.reduce((I,C)=>I+(C.value||0),0).toFixed(2):0,x=n=>{console.log("configureRoom",n,l.locationId);const{open:I,close:C}=J({component:Zs,attrs:{locationId:l.locationId,id:n,onConfirm(d){console.log("onConfirm",d),f("close"),C()},onClose(){C()}}});I()},m=()=>{console.log("configureWater",l.locationId);const{open:n,close:I}=J({component:ye,attrs:{locationId:l.locationId,month:l.month,multiple:!0,onConfirm(C){console.log("onConfirm",C),f("close"),I()},onClose(){I()}}});n()},u=n=>{console.log("configureWater",n,l.locationId);const{open:I,close:C}=J({component:ye,attrs:{locationId:l.locationId,id:n,month:l.month,onConfirm(d){console.log("onConfirm",d),f("close"),C()},onClose(){C()}}});I()};X(()=>l.floors);const a={formatNumber:n=>new Intl.NumberFormat("es-CL",{currency:"CLP"}).format(n)};return(n,I)=>(M(),N("div",Ya,[e("div",za,[e("div",Ba,[e("div",ja,[w(e("input",{type:"text",placeholder:"Buscar...",class:"w-full p-5 border border-gray-200","onUpdate:modelValue":I[0]||(I[0]=C=>g.value=C)},null,512),[[S,g.value]])]),e("div",qa,[e("button",{class:"p-4 w-full cursor-pointer border border-gray-300 hover:bg-gray-200 block",onClick:I[1]||(I[1]=C=>m())},Wa)])])]),(M(!0),N(Q,null,oe(A.value,C=>(M(),N("div",{key:C.id},[e("h2",{id:`accordion-collapse-heading-${C._id}`},[e("button",{type:"button",class:"flex items-center justify-between w-full p-5 font-medium rtl:text-right text-gray-500 border border-gray-200focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 hover:bg-gray-100 gap-3","data-accordion-target":`#accordion-collapse-body-${C._id}`,"aria-expanded":"true","aria-controls":`accordion-collapse-body-${C._id}`},[e("strong",null,k(C.name)+" ("+k(C.rooms&&C.rooms.length)+") | "+k(c(C))+" m2 | $"+k(a.formatNumber(b(C))),1),Ja],8,Za)],8,Ka),e("div",{id:`accordion-collapse-body-${C._id}`,class:"hidden","aria-labelledby":`accordion-collapse-heading-${C._id}`},[e("div",Qa,[e("div",en,[e("div",tn,[e("div",on,[e("strong",null,k(C.name),1),e("span",ln,"Unidades: "+k(C.rooms&&C.rooms.length),1)])]),e("div",sn,[(M(!0),N(Q,null,oe(C.rooms,d=>(M(),N("div",{class:O(["lg:col-span-4 md:col-span-6 col-span-12 border p-2 bg-gray-100 hover:bg-gray-200",{"bg-blue-200 border-blue-400 hover:bg-blue-300 border-2":v.value===d._id,"bg-yellow-100":d.value+d.penaltyFee+p(d._id)!=s(d._id)}]),onClick:_=>v.value=d._id,key:d._id},[e("div",nn,[e("div",rn,[e("span",dn,k(d.name),1),cn,e("div",un,[e("div",pn,[e("small",null,"m2 "+k(d.m2||"- - -"),1)]),e("div",vn,[e("small",null,"GC: $ "+k(a.formatNumber(d.value)),1)]),e("div",mn,[e("small",null,"M: $ "+k(a.formatNumber(d.penaltyFee)),1)]),gn,e("div",hn,[e("small",null,"TOTAL: $ "+k(a.formatNumber(d.value+d.penaltyFee+p(d._id))),1)]),e("div",_n,[e("small",null,"AGUA: $ "+k(a.formatNumber(p(d._id))),1)]),e("div",bn,[e("small",null,"PAGADO: $ "+k(a.formatNumber(s(d._id))),1)]),d.resident?(M(),N("div",yn,[e("div",fn,[$n,e("span",null,k(d.resident.name),1)])])):W("",!0),d.owner?(M(),N("div",xn," P: "+k(d.owner.name),1)):W("",!0),wn])]),e("div",Cn,[e("small",{class:"cursor-pointer border border-gray-300 hover:bg-gray-200 block",onClick:_=>$(d._id)},An,8,En),e("small",{class:"cursor-pointer border border-gray-300 hover:bg-gray-200 block",onClick:_=>u(d._id)},In,8,Rn)]),e("div",Mn,[e("small",{class:"cursor-pointer border border-gray-300 hover:bg-gray-200 block",onClick:_=>x(d._id)},Tn,8,Fn)])])],10,an))),128))])])])],8,Xa)]))),128))]))}}),Un={class:"lg:container mx-auto"},Dn={class:"grid grid-cols-12 border p-2 sticky-top"},Ln={class:"col-span-12"},Pn={class:"text-2xl"},Vn={class:"block"},Gn={class:"grid grid-cols-3 text-center bg-gray-50 border border-gray-300 py-5 rounded my-3"},Yn={class:"col-span-3 md:col-span-1"},zn=e("small",{class:"block"},"ESTAS RECAUDANDO: ",-1),Bn={class:"col-span-3 md:col-span-1"},jn=e("small",{class:"block"},"CONFIGURASTE: ",-1),qn={class:"text-green-500"},Hn={class:"col-span-3 md:col-span-1"},Wn=e("small",{class:"block"},"DIFERENCIA: ",-1),Kn={class:"text-yellow-500"},Zn={class:"grid grid-cols-3 text-center bg-gray-50 border border-gray-300 py-5 rounded my-3"},Jn={class:"col-span-3 md:col-span-1"},Xn=e("small",{class:"block"},"TOTAL M2: ",-1),Qn={class:"text-gray-700 font-bold"},er={class:"col-span-3 md:col-span-1"},tr=e("small",{class:"block"},"VALOR M2: ",-1),or={class:"text-gray-700 font-bold"},lr={class:"col-span-3 md:col-span-1"},sr=e("small",{class:"block"},"TOTAL UNIDADES: ",-1),ar={class:"text-gray-700 font-bold"},nr={class:"col-span-2"},rr={class:"col-span-4"},dr={class:"col-span-2"},cr={class:"col-span-2"},ir={class:"col-span-12"},ur=e("div",{class:"mb-4 border-b border-gray-200"},[e("ul",{class:"flex flex-wrap -mb-px text-sm font-medium text-center",id:"default-tab","data-tabs-toggle":"#default-tab-content",role:"tablist"},[e("li",{class:"me-2",role:"presentation"},[e("button",{class:"inline-block p-4 border-b-2 rounded-t-lg",id:"profile-tab","data-tabs-target":"#profile",type:"button",role:"tab","aria-controls":"profile","aria-selected":"false"}," Unidades ")]),e("li",{class:"me-2",role:"presentation"},[e("button",{class:"inline-block p-4 border-b-2 rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300",id:"dashboard-tab","data-tabs-target":"#dashboard",type:"button",role:"tab","aria-controls":"dashboard","aria-selected":"false"}," Ingresos ")]),e("li",{class:"me-2",role:"presentation"},[e("button",{class:"inline-block p-4 border-b-2 rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300",id:"settings-tab","data-tabs-target":"#settings",type:"button",role:"tab","aria-controls":"settings","aria-selected":"false"}," Egresos ")]),e("li",{role:"presentation"},[e("button",{class:"inline-block p-4 border-b-2 rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300",id:"report-tab","data-tabs-target":"#report",type:"button",role:"tab","aria-controls":"report","aria-selected":"false"}," Informes ")]),e("li",{role:"presentation"},[e("button",{class:"inline-block p-4 border-b-2 rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300",id:"binnacle-tab","data-tabs-target":"#binnacle",type:"button",role:"tab","aria-controls":"binnacle","aria-selected":"false"}," Bitacora ")])])],-1),pr={id:"default-tab-content"},vr={class:"hidden1 p-4 rounded-lg bg-gray-50",id:"profile",role:"tabpanel","aria-labelledby":"profile-tab"},mr={class:"hidden p-4 rounded-lg bg-gray-50 dark:bg-gray-800",id:"dashboard",role:"tabpanel","aria-labelledby":"dashboard-tab"},gr={class:"hidden p-4 rounded-lg bg-gray-50 dark:bg-gray-800",id:"settings",role:"tabpanel","aria-labelledby":"settings-tab"},hr=e("div",{class:"hidden p-4 rounded-lg bg-gray-50 dark:bg-gray-800",id:"contacts",role:"tabpanel","aria-labelledby":"contacts-tab"},[e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},[ce(" This is some placeholder content the "),e("strong",{class:"font-medium text-gray-800 dark:text-white"},"Contacts tab's associated content"),ce(". Clicking another tab will toggle the visibility of this one for the next. The tab JavaScript swaps classes to control the content visibility and styling. ")])],-1),_r={class:"hidden p-4 rounded-lg bg-gray-50 dark:bg-gray-800",id:"report",role:"tabpanel","aria-labelledby":"report-tab"},br={class:"space-3"},yr={class:"grid grid-cols-2 gap-3"},fr={class:"col-span"},$r={class:"col-span"},xr={class:"col-span"},wr={class:"col-span"},Cr=e("div",{class:"hidden p-4 rounded-lg bg-gray-50 dark:bg-gray-800",id:"binnacle",role:"tabpanel","aria-labelledby":"binnacle-tab"},[e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},[ce(" This is some placeholder content the "),e("strong",{class:"font-medium text-gray-800 dark:text-white"},"binnacle tab's associated content"),ce(". Clicking another tab will toggle the visibility of this one for the next. The tab JavaScript swaps classes to control the content visibility and styling. ")])],-1),Rr=K({__name:"admin",setup(P){const D=Ae(),l=r(),f=r(),g=r([]),v=r([]),s=r({name:"",address:"",city:"",region:"",zip:"",phone:"",rut:"",email:"",notes:"",floors:[],recaudation:0,_id:"",bankInfo:""}),p=r(!0);xe(()=>{console.log("nextTick",s),setTimeout(()=>{me()},1e3)});const $=r(D.currentRoute.value.params.id),A=r(new Date().toISOString().substr(0,10)),c=r(),b=()=>{const t=s.value.floors;return t?t.reduce((o,Y)=>Y.rooms?o+Y.rooms.reduce((h,L)=>h+(L.value||0),0):o,0).toFixed(2):0 .toFixed(2)},x=X(()=>{const t=s.value.floors;return t?t.reduce((o,Y)=>Y.rooms?o+Y.rooms.length:o,0):0 .toFixed(2)});X(()=>{const t=s.value.floors;return t?t.reduce((o,Y)=>o+Y.rooms.reduce((h,L)=>h+(L.m2||0),0),0).toFixed(2):0 .toFixed(2)});const m=()=>{c.value=H().format("YYYY-MM")},u=async()=>{try{p.value=!0;const t=D.currentRoute.value.params.id,o=await F.get(`/location/${t}`);s.value=o.data,setTimeout(()=>{me()},1e3),console.log(l.value),l.value.load(),f.value.load(),I(),d()}catch{R({type:"error",title:"Error",text:"Error loading location"})}finally{p.value=!1}},a=()=>{c.value=H(c.value).subtract(1,"month").format("YYYY-MM")},n=()=>{c.value=H(c.value).add(1,"month").format("YYYY-MM")},I=async()=>{try{const t=await F.get(`/payment?location=${s.value._id}&month=${c.value}`);g.value=t.data}catch{}},C=async()=>{try{p.value=!0;const t=await F.post(`/location/${s.value._id}/pending?month=${c.value}`,{month:c.value});R({type:"success",title:"Pagos pendientes generados",text:"Se han generado los pagos pendientes"})}catch{R({type:"error",title:"Error",text:"Error generando pagos pendientes"})}finally{p.value=!1}},d=async()=>{try{const t=await F.get(`/location/${s.value._id}/water?month=${c.value}`);console.log({response:t}),v.value=t.data}catch{}};le(()=>{me(),D.currentRoute.value.query.month?c.value=D.currentRoute.value.query.month:(c.value=new Date().toISOString().substr(0,7),D.push({query:{month:c.value}})),u()}),se(()=>c.value,()=>{D.push({query:{month:c.value}}),u()});const _=async()=>{const t=new ve;p.value=!0;let o=15;t.setFontSize(16),t.setFont("helvetica","bold"),t.text(`GASTOS COMUNES ${s.value.name}`,100,o,{align:"center"});const{data:Y}=await F.get(`/location/${$.value}/water?month=${c.value}`),{data:h}=await F.get(`/location/${$.value}/pending?month=${c.value}`);console.log({pendings:h}),t.setFontSize(12),t.setFont("helvetica","normal"),o+=15,t.setFontSize(12),t.setFont("helvetica","normal"),s.value.floors.forEach(L=>{L.rooms.forEach(G=>{var _e;t.text(`RUT: ${s.value.rut}`,20,o),o+=5,t.text(`Direccion: ${s.value.address}`,20,o),t.rect(20,o+2,170,.1,"F"),o+=15,t.setFont("helvetica","bold"),t.setFontSize(14);const E=H(c.value).format("MMMM [de] YYYY");t.text(`${E.toUpperCase()}`,100,o,{align:"center"}),t.setFontSize(12),t.text("Se\xF1or Copropietario",20,o+10),o+=5,t.text(`Local/Oficina N\xB0: ${G.name}`,20,o+10),o+=10,t.setFont("helvetica","bold"),t.setFont("helvetica","normal"),t.rect(20,o+2,170,.1,"F"),o+=5;const y=(_e=Y.find(B=>B.room===G._id))==null?void 0:_e.value,{pending:U,penalty_amount:z}=h[G._id],ue=U.filter(B=>B.category=="Recaudacion de gastos comun").reduce((B,re)=>B+re.amount,0),ie=U.find(B=>B.month==c.value),Ce=U.filter(B=>B.category!="Recaudacion de gastos comun").filter(B=>B.category!="Agua").reduce((B,re)=>B+re.amount,0),he=[{name:"Gastos Comunes",amount:(ie==null?void 0:ie.amount)||0},{name:"Multa GC",amount:z||0},{name:"Multa Otros",amount:Ce||0},{name:"Agua",amount:y||0},{name:"Saldo anterior",amount:ue-((ie==null?void 0:ie.amount)||0)}];he.forEach(B=>{o+=5,t.text(B.name,20,o);const re=B.amount;t.text(`$${V(re)}`,190,o,{align:"right"})}),t.rect(20,o+2,170,.1,"F"),o+=10,t.setFont("helvetica","bold");const Ee=he.reduce((B,re)=>B+re.amount||0,0);t.text(`TOTAL: $${V(Ee)}`,20,o+10),t.rect(120,o+10,70,40),t.text("FIRMA",132,o+18,{align:"center"}),o+=20,t.setFontSize(12),t.text("Datos de Transferencia",20,o),t.setFont("helvetica","normal"),o+=7,t.text(`${s.value.bankInfo||""}`,20,o),t.addPage(),o=15})}),o+=5,t.output("dataurlnewwindow",{filename:`GASTOS-COMUNES-${s.value.name}-${c.value}.pdf`}),p.value=!1},q=async()=>{const t=new ve;let o=15;t.setFontSize(16),t.setFont("helvetica","bold"),t.text(`GASTOS COMUNES ${s.value.name}`,100,o,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","normal"),o+=15,t.text("RUT: 65.188.731-3",20,o),o+=5,t.text("Direccion: Bulnes 136 Talcahuano",20,o),t.rect(20,o+2,170,.1,"F"),o+=15,t.setFont("helvetica","bold"),t.setFontSize(14);const Y=H(c.value).format("MMMM [de] YYYY");t.text(`GASTOS DE ${Y.toUpperCase()}`,100,o,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","normal");const{data:h}=await F.get(`/expense?location=${s.value._id}&month=${c.value}`),L=h.reduce((y,U)=>{const z=U.category.replace(/\s/g,"").toLowerCase();return console.log({categoryClear:z}),y[z]||(y[z]={name:U.category,items:[]}),y[z].items.push(U),y},{});console.log({items:L});const G=y=>{let U=0;return y.items?(y.items.forEach(z=>{U+=z.amount}),U):0};Object.values(L).forEach(y=>{console.log(y),o+=10,t.setFont("helvetica","bold"),t.text(y.name,20,o),t.setFont("helvetica","normal"),t.setFont("helvetica","bold"),t.text(`$${V(G(y))}`,190,o,{align:"right"}),t.setFont("helvetica","normal"),t.rect(20,o+2,170,.1,"F"),o+=5,y.items.forEach(U=>{o+=5,t.text(U.name,20,o),t.text(`$${V(U.amount.toString())}`,190,o,{align:"right"})})}),o+=10,t.rect(20,o+2,170,.1,"F"),t.setFont("helvetica","bold"),t.text("TOTAL",20,o+10);const E=h.reduce((y,U)=>y+(U.amount||0),0);t.text(`$${V(E)}`,190,o+10,{align:"right"}),t.output("dataurlnewwindow",{filename:`GASTOS-COMUNES-${s.value.name}-${c.value}.pdf`})},i=async()=>{const t=new ve;let o=15;t.setFontSize(16),t.setFont("helvetica","bold"),t.text(`GASTOS COMUNES ${s.value.name}`,100,o,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","normal"),o+=15,t.text(`RUT: ${s.value.rut}`,20,o),o+=5,t.text(`Direccion: ${s.value.address}`,20,o),t.rect(20,o+2,170,.1,"F"),o+=15,t.setFont("helvetica","bold"),t.setFontSize(14);const Y=`GASTO COMUN DE ${H(c.value,"YY-MM").format("MMMM [DE] YYYY")}`.toUpperCase();t.text(Y,100,o,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","normal");const{data:h}=await F.get(`/payment?location=${s.value._id}&month=${c.value}`),L=h.reduce((y,U)=>{const z=U.category.replace(/\s/g,"").toLowerCase();return y[z]||(y[z]={name:U.category,items:[]}),y[z].items.push(U),y},{});console.log({details:L}),o+=5,t.setFont("helvetica","bold"),t.text("Total a recaudar",20,o+10),t.setFont("helvetica","normal"),o+=10,t.rect(20,o+2,170,.1,"F"),o+=10,Object.values(L).forEach(y=>{console.log({detail:y}),t.setFont("helvetica","bold"),t.setFont("helvetica","normal"),t.text(y.name,20,o);const U=y.items.reduce((z,ue)=>z+ue.amount,0);t.text(`$${V(U)}`,190,o,{align:"right"}),o+=5}),t.rect(20,o+2,170,.1,"F"),t.setFont("helvetica","bold"),t.text("TOTAL",20,o+10);const G=h.reduce((y,U)=>y+U.amount,0);t.text(`$${V(G)}`,190,o+10,{align:"right"}),o+=20,t.setFont("helvetica","bold"),t.text("Pagados",20,o+10),t.setFont("helvetica","normal"),o+=10,t.rect(20,o+2,170,.1,"F"),o+=10,Object.values(L).forEach(y=>{console.log({detail:y}),t.setFont("helvetica","bold"),t.setFont("helvetica","normal"),t.text(y.name,20,o);const U=y.items.filter(z=>z.status=="paid").reduce((z,ue)=>z+ue.amount,0);t.text(`$${V(U)}`,190,o,{align:"right"}),o+=5}),t.rect(20,o+2,170,.1,"F"),t.setFont("helvetica","bold"),t.text("TOTAL",20,o+10);const E=h.filter(y=>y.status=="paid").reduce((y,U)=>y+U.amount,0);t.text(`$${V(E)}`,190,o+10,{align:"right"}),t.output("dataurlnewwindow",{filename:`INGRESOS ${s.value.name} ${c.value}.pdf`})},T=async()=>{try{const t=new ve;p.value=!0;let o=15;t.setFontSize(16),t.setFont("helvetica","bold"),t.text(`DEUDORES ${s.value.name}`,100,o,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","normal"),o+=15,t.text(`RUT: ${s.value.rut}`,20,o),o+=5,t.text(`Direccion: ${s.value.address}`,20,o),t.rect(20,o+2,170,.1,"F"),o+=15,t.setFont("helvetica","bold"),t.setFontSize(14);const Y=`PENDIENTES HASTA ${H(c.value,"YY-MM").format("MMMM [DE] YYYY")}`.toUpperCase();t.text(Y,100,o,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","normal");const{data:h}=await F.get(`/location/${s.value._id}/pending?month=${c.value}`);o+=5,t.rect(20,o+2,170,.1,"F"),o+=15,Object.values(h).forEach(G=>{const E=G.pending.reduce((y,U)=>y+U.amount,0);E!=0&&(t.setFont("helvetica","bold"),t.text(`${G.room.name}`,20,o),t.text(`$${V(E+G.penalty_amount)}`,190,o,{align:"right"}),t.setFont("helvetica","normal"),t.rect(20,o+2,170,.1,"F"),o+=3,G.pending.forEach(y=>{o+=5,t.text(`- ${y.name}`,20,o),t.text(`$${V(y.amount)}`,190,o,{align:"right"}),o>250&&(t.addPage(),o=15)}),G.penalty_amount&&(o+=5,t.text("- Multa Gasto Comun",20,o),t.text(`$${V(G.penalty_amount)}`,190,o,{align:"right"})),o+=10)}),o+=5,t.rect(20,o+2,170,.1,"F"),t.setFont("helvetica","bold"),t.text("TOTAL",20,o+10);const L=Object.values(h).reduce((G,E)=>G+E.pending.reduce((y,U)=>y+U.amount,0),0);t.text(`$${V(L)}`,190,o+10,{align:"right"}),t.output("dataurlnewwindow",{filename:`DEUDORES-${s.value.name}-${c.value}.pdf`}),p.value=!1}catch(t){console.log("error pending",t),R({type:"error",title:"Error",text:"Error generando deudores"})}finally{p.value=!1}};return(t,o)=>{const Y=ee("Loading");return M(),N("div",Un,[Z(Y,{visible:p.value},null,8,["visible"]),e("div",Dn,[e("div",Ln,[e("h1",Pn,k(s.value.name),1),e("span",Vn,k(s.value.address)+", "+k(s.value.city)+" - "+k(s.value.region),1),e("div",Gn,[e("div",Yn,[zn,e("span",{class:O({"text-red-500":b()<s.value.recaudation,"text-green-500":b()>=s.value.recaudation})},"$"+k(V(b())),3)]),e("div",Bn,[jn,e("span",qn,"$"+k(V(s.value.recaudation||0)),1)]),e("div",Hn,[Wn,e("span",Kn,"$"+k(V(b()-s.value.recaudation)),1)])]),e("div",Zn,[e("div",Jn,[Xn,e("span",Qn,k(s.value.totalm2),1)]),e("div",er,[tr,e("span",or,"$"+k((s.value.recaudation/s.value.totalm2).toFixed(2)),1)]),e("div",lr,[sr,e("span",ar,k(x.value),1)])])]),e("div",nr,[e("button",{onClick:o[0]||(o[0]=h=>a()),class:"border border-gray-400 rounded bg-gray-200 w-full p-2"}," ANTERIOR ")]),e("div",rr,[w(e("input",{type:"month",class:"w-full p-2 border rounded","onUpdate:modelValue":o[1]||(o[1]=h=>c.value=h)},null,512),[[S,c.value]])]),e("div",dr,[e("button",{onClick:o[2]||(o[2]=h=>n()),class:"border border-gray-400 rounded bg-gray-200 w-full p-2"}," SIGUIENTE ")]),e("div",cr,[e("button",{onClick:o[3]||(o[3]=h=>m()),class:"border border-gray-400 rounded bg-gray-200 w-full p-2"}," ACTUAL ")]),e("div",{class:"col-span-2"},[e("button",{onClick:u,class:"w-full border border-green-500 bg-green-400 text-white p-2 rounded h-100"}," Recargar ")]),e("div",ir,[ur,e("div",pr,[e("div",vr,[e("button",{onClick:o[4]||(o[4]=h=>C()),class:"bg-gray-200 p-2"}," Generar detalle de pagos pendientes "),Z(Nn,{onClose:u,locationId:s.value._id,floors:s.value.floors,payments:g.value,waterlist:v.value,month:c.value,date:A.value,onUpdate:u},null,8,["locationId","floors","payments","waterlist","month","date"])]),e("div",mr,[Z(gl,{ref_key:"paymentsRef",ref:f,month:c.value,locationId:$.value},null,8,["month","locationId"])]),e("div",gr,[Z(Et,{ref_key:"expensesRef",ref:l,month:c.value,locationId:$.value},null,8,["month","locationId"])]),hr,e("div",_r,[e("div",br,[e("div",yr,[e("div",fr,[e("button",{class:"w-full bg-gray-200 text-center py-5 hover:bg-gray-300",onClick:o[5]||(o[5]=h=>_())}," Generar detalle por unidad ")]),e("div",$r,[e("button",{class:"w-full bg-gray-200 text-center py-5 hover:bg-gray-300",onClick:o[6]||(o[6]=h=>q())}," Generar detalle de gastos ")]),e("div",xr,[e("button",{class:"w-full bg-gray-200 text-center py-5 hover:bg-gray-300",onClick:o[7]||(o[7]=h=>i())}," Generar detalle de ingresos ")]),e("div",wr,[e("button",{class:"w-full bg-gray-200 text-center py-5 hover:bg-gray-300",onClick:o[8]||(o[8]=h=>T())}," Generar deudores ")])])])]),Cr])])])])}}});export{Rr as default};
